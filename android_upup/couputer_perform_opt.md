[回目录页](..)

# Android性能优化

# Android 布局优化

* 1. 删除布局中无用的控件和层次，其次有选择地使用性能比较低的ViewGroup

* 2. 采用标签,标签,ViewStub

* 3. 避免多度绘制
   
> * 移除默认的 Window 背景  
> * 移除不必要的背景
> * 自定义控件使用 clipRect() 和 quickReject() 优化 

* 4. 使用ConstraintLayout约束布局


# Android绘制优化

绘制优化是指**View的onDraw方法要避免执行大量的操作，**这主要体现在两个方面：

①onDraw中不要创建新的局部对象。

因为onDraw方法可能会被频繁调用，这样就会在一瞬间产生大量的临时对象，这不仅占用了过多的内存而且还会导致系统更加频繁gc，降低了程序的执行效率。

②onDraw方法中不要做耗时的任务，也不能执行成千上万次的循环操作，尽管每次循环都很轻量级，但是大量的循环仍然十分抢占CPU的时间片，这会造成View的绘制过程不流畅。

按照Google官方给出的性能优化典范中的标准，View的绘制频率保证60fps是最佳的，这就要求每帧绘制时间不超过16ms(16ms = 1000/60)，虽然程序很难保证**16ms**这个时间，但是尽量降低onDraw方法中的复杂度总是切实有效的。


# 内存泄漏优化

### Android一般在什么情况下会出现内存泄漏？
①集合类泄漏 ②单例/静态变量造成的内存泄漏 ③匿名内部类/非静态内部类 ④资源未关闭造成的内存泄漏

大概可以分为以上几类，还有一些经常会听到的Hanlder,AsyncTask引起内存泄漏，都属于上述③中的情况。

那么上述四种情况是怎么造成的内存泄漏，具体是什么原因，以及Android中一些知名的引起内存泄漏的原因，以及解决方法是怎么样的？

# ListView优化，RecyclerView优化 ，BitMap优化
 
1. 使用ViewHolder模式来提高效率

2. 异步加载：耗时的操作放在异步线程中
   异步加载时通过设置tag标识位来规避view的错位问题
   
# 其他性能优化建议

   ①避免过度的创建对象
   
   ②不要过度使用枚举，枚举占用的内存空间要比整型大
   
   ③常量请使用static final来修饰
   
   ④使用一些Android特有的数据结构，比如SparseArray和Pair等
   
   ⑤适当采用软引用和弱引用
   
   ⑥采用内存缓存和磁盘缓存
   
   ⑦尽量采用静态内部类，这样可以避免潜在的由于内部类而导致的内存泄漏。
   
   以上是关于Android性能优化方面，我们一些入手点。从这些方面，我们可以在平时的开发中注意，避免类似错误，提高Android程序的性能，但是其中一些方面的要求则需要我们不断的学习，以及平时良好的意识与习惯。由于自己开发经验几乎为0，没办法根据实际经验来说明，只能写下这篇文章来提醒自己以后开发的时候需要注意和培养的地方。





